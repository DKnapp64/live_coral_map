






<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />


<style>
.center_map {
    margin: auto;
    width: 80%;
    height: 80%;
    padding: 10px;
}
</style>


<title> Live Coral Bleaching | ASU GDCS </title>



<script type='text/javascript' src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB6TTiAGXhdT8NdHKluduXz8aYvg-mGkXU&libraries=visualization"></script>

<!-- <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> -->
<script>

var controllist = [];
var tilerlist = [];
var map;
var heatmap;


function add_marker(latlong, type, content_str, map, infowindow){
    var marker = new google.maps.Marker({
         position: latlong,
         icon: {
            path: google.maps.SymbolPath.CIRCLE,
            scale: 2,
            strokeColor: '#C93211'
          },
         //icon: icons[features[i].type].icon,
         map: map
       });

       google.maps.event.addListener(marker, 'click', function() {

       var iwContent =  content_str;
         infowindow.setContent(content_str);
         infowindow.open(map, marker);
        });
   
}



function CSVToArray( strData, strDelimiter ){
	// Check to see if the delimiter is defined. If not,
	// then default to comma.
	strDelimiter = (strDelimiter || ",");

	// Create a regular expression to parse the CSV values.
	var objPattern = new RegExp(
		(
			// Delimiters.
			"(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +

			// Quoted fields.
			"(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +

			// Standard fields.
			"([^\"\\" + strDelimiter + "\\r\\n]*))"
		), "gi");

	// Create an array to hold our data. Give the array
	// a default empty first row.
	var arrData = [[]];

	// Create an array to hold our individual pattern
	// matching groups.
	var arrMatches = null;

	// Keep looping over the regular expression matches
	// until we can no longer find a match.
	while (arrMatches = objPattern.exec( strData ))
	{
		// Get the delimiter that was found.
		var strMatchedDelimiter = arrMatches[ 1 ];

		// Check to see if the given delimiter has a length
		// (is not the start of string) and if it matches
		// field delimiter. If id does not, then we know
		// that this delimiter is a row delimiter.
		if (strMatchedDelimiter.length && (strMatchedDelimiter != strDelimiter))
		{
			// Since we have reached a new row of data,
			// add an empty row to our data array.
			arrData.push( [] );

		}

		// Now that we have our delimiter out of the way,
		// let's check to see which kind of value we
		// captured (quoted or unquoted).
		if (arrMatches[ 2 ]){
			// We found a quoted value. When we capture
			// this value, unescape any double quotes.
			var strMatchedValue = arrMatches[ 2 ].replace(
				new RegExp( "\"\"", "g" ),
				"\""
				);

		} else 
		{
			// We found a non-quoted value.
			var strMatchedValue = arrMatches[ 3 ];
		}

		// Now that we have our value string, let's add
		// it to the data array.
		arrData[ arrData.length - 1 ].push( strMatchedValue );
	}

	// Return the parsed data.
	return( arrData );
}








function initialize_coral_map() {

var infowindow;
var startBounds = new google.maps.LatLngBounds(
    new google.maps.LatLng(20.7,-156.6),
    new google.maps.LatLng(21.0,-156.55));
var mapMinZoom = 7;
var mapMaxZoom = 25;


    map = new google.maps.Map(document.getElementById("map_canvas"),{maxZoom: mapMaxZoom, minZoom:mapMinZoom, mapTypeId:'hybrid'});

    <!-- map.fitBounds(mapBounds); -->
    map.fitBounds(startBounds);


	//var returnValue = "";
	//var request = new XMLHttpRequest();
    //request.open("GET", "data_points.csv", false);
    //document.write("hi")
	//request.send(null);
	//returnValue = request.responseText;
    //var data = CSVToArray(returnValue);



    //var features = []
    //for (var index = 0; index < data.length; index++)
    //{
    //    var ll = new google.maps.LatLng(parseFloat(data[i][0]), parseFloat(data[i][1]))
    //    features.push({position: ll, dateinfo: data[i][2]})
    //}
        var features = [
          {
            position: new google.maps.LatLng(20.78839892, 	-156.56087586),
            type: 'bleached',
            dateinfo: "Date 1"
          },
          {
            position: new google.maps.LatLng(20.88142837, 	-156.69040599),
            type: 'bleached',
            dateinfo: "Date 2"
          },
          {
            position: new google.maps.LatLng(20.91575741, 	-156.69788421),
            type: 'bleached',
            dateinfo: "Date 3"
          },
	   {
            position: new google.maps.LatLng(20.91675741, 	-156.69988421),
            type: 'bleached',
            dateinfo: "Date 4"
          },
		         {
            position: new google.maps.LatLng(20.81575741, 	-156.65788421),
            type: 'bleached',
            dateinfo: "Date 5"
          },
		         {
            position: new google.maps.LatLng(20.96575741, 	-156.64788421),
            type: 'bleached',
            dateinfo: "Date 6"
          }
        ];


        infowindow = new google.maps.InfoWindow();

        // Event that closes the Info Window with a click on the map
        google.maps.event.addListener(map, 'click', function() {
           infoWindow.close();
        });



        // Create markers.
        for (var i = 0; i < features.length; i++) {
            add_marker(features[i].position, features[i].type, features[i].dateinfo, map, infowindow)
         };

        var heatmapData = [];
        for (var i = 0; i < features.length; i++) {
            heatmapData.push(features[i].position);
        }

        heatmap = new google.maps.visualization.HeatmapLayer({
          data: heatmapData
        });
        heatmap.setMap(map);

}

function selectControl(item) {
    map.overlayMapTypes.clear();
    if (item < tilerlist.length) {
      map.overlayMapTypes.insertAt(0, tilerlist[item]);
    }
    for (i = 0; i < controllist.length; i++ ) {
      //controllist[i].firstChild.firstChild.style.color = 'rgb(25,25,25)';
      controllist[i].deselect();
    }
    //controllist[item].firstChild.firstChild.style.color = caogreen;
    controllist[item].select();
}



function OverlayControl(controlDiv, map, id, dispTxt) {
  // Set CSS for the control border.
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor ='#fff';
  controlUI.style.border = '2px solid #fff';
  controlUI.style.borderRadius = '3px';
  controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
  controlUI.style.cursor = 'pointer';
  controlUI.style.marginBottom = '22px';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Select Coverage layer';
  controlDiv.appendChild(controlUI);
  this.controlUI = controlUI;

  // Set CSS for the control interior.
  var controlText = document.createElement('div');
  controlText.style.color = 'rgb(25,25,25)';
  controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
  controlText.style.fontSize = '16px';
  controlText.style.lineHeight = '28px';
  controlText.style.paddingLeft = '2px';
  controlText.style.paddingRight = '2px';
  controlText.style.paddingUp = '2px';
  controlText.style.paddingDown = '2px';
  controlText.innerHTML = dispTxt;
  controlUI.appendChild(controlText);
  this.controlText = controlText;

  // Setup the click event listeners: simply set the map to Chicago.
  this.controlUI.addEventListener('click', function() {
    selectControl(id);
  });
}
function OverlayDiv(map, id, dispTxt) {
  this.div = document.createElement('div');
  this.div.index = 1;
  this.control = new OverlayControl(this.div, map, id, dispTxt);
}
OverlayDiv.prototype.select = function() {
  this.control.controlText.style.color = caogreen;
}
OverlayDiv.prototype.deselect = function() {
  this.control.controlText.style.color = 'rgb(25,25,25)';
}

function SelectionControl(controlDiv, map) {
  // Set CSS for the control border.
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor ='#fff';
  controlUI.style.border = '2px solid #fff';
  controlUI.style.borderRadius = '3px';
  controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
  controlUI.style.cursor = 'pointer';
  controlUI.style.marginBottom = '22px';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Select Coverage layer';
  controlDiv.appendChild(controlUI);
  this.controlUI = controlUI;

  // Set CSS for the control interior.
  var controlText = document.createElement('div');
  controlText.style.color = 'rgb(25,25,25)';
  controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
  controlText.style.fontSize = '16px';
  controlText.style.lineHeight = '28px';
  controlText.style.paddingLeft = '2px';
  controlText.style.paddingRight = '2px';
  controlText.style.paddingUp = '2px';
  controlText.style.paddingDown = '2px';
  controlText.innerHTML = 'Select Area';
  controlUI.appendChild(controlText);
  this.controlText = controlText;

  // Setup the click event listeners
  this.controlUI.addEventListener('click', function() {
    if (!drawing) {
      drawingManager.setDrawingMode('rectangle');
      //selectionDiv.deactivate();
      drawing = true;
    } else {
      drawingManager.setDrawingMode();
      selectionDiv.activate();
      drawing = false;
    }
  });
}
function SelectionDiv(map) {
  this.div = document.createElement('div');
  this.div.index = 1;
  this.control = new SelectionControl(this.div, map);
}
SelectionDiv.prototype.activate = function() {
  this.control.controlText.style.color = caogreen;
}
SelectionDiv.prototype.deactivate = function() {
  this.control.controlText.style.color = 'rgb(225,225,225)';
}



</script>

</head>



















<body class="page page-id-2656 page-template-default  not-admin wpb-js-composer js-comp-ver-4.3.5 vc_responsive" 
data-header-inherit-rc="false" data-header-search="true" data-animated-anchors="false" data-ajax-transitions="false" 
data-full-width-header="false" data-slide-out-widget-area="false" data-loading-animation="none" 
data-bg-header="false" data-ext-responsive="true" data-header-resize="0" data-header-color="light"  
data-smooth-scrolling="1" data-responsive="1" bgcolor=#000000 onload="initialize_coral_map()">




<div>
<p>&nbsp;</p>
<div>


<div id="map_canvas" class="center_map"></div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="./papaparse.min.js"></script>
<script>window.jQuery || document.write('<script src="{{url_for('static', filename='jquery-3.2.1.js') }}">\x3C/script>')</script>

</body>


</body>
</html>


